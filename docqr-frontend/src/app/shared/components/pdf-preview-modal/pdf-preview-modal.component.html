<!-- Modal Backdrop -->
<div 
  *ngIf="isOpen" 
  class="modal-backdrop fixed inset-0 bg-black bg-opacity-75 z-[9999] flex items-center justify-center p-4"
  style="z-index: 9999; position: fixed; top: 0; left: 0; right: 0; bottom: 0;"
  (click)="onBackdropClick($event)">
  
  <!-- Modal Content -->
  <div 
    class="modal-content bg-white rounded-xl shadow-2xl w-full max-w-7xl h-full max-h-[95vh] flex flex-col"
    (click)="$event.stopPropagation()">
    
    <!-- Header del Modal - Simplificado -->
    <div class="flex items-center justify-between p-4 border-b border-gray-200 bg-gray-50 rounded-t-xl">
      <h2 class="text-lg font-bold text-gray-900">{{ documentName || 'Vista Previa del Documento' }}</h2>
      
      <!-- Solo botón de cerrar -->
      <button 
        type="button"
        (click)="closeModal()"
        class="p-2 rounded-lg hover:bg-red-100 hover:text-red-600 transition-colors"
        title="Cerrar">
        <span class="material-symbols-outlined">close</span>
      </button>
    </div>

    <!-- PDF Viewer Container -->
    <div class="flex-1 overflow-hidden bg-gray-100" [class.dark-mode]="darkMode">
      <!-- Mensaje de error si no hay URL válida -->
      <div *ngIf="!safePdfUrl && isOpen" class="flex items-center justify-center h-full">
        <div class="text-center p-8">
          <span class="material-symbols-outlined text-6xl text-gray-400 mb-4">error_outline</span>
          <p class="text-gray-600 text-lg mb-2">No se pudo cargar el documento</p>
          <p class="text-gray-500 text-sm">El archivo PDF no está disponible o la URL es inválida</p>
        </div>
      </div>
      
      <!-- Usar iframe simple para mostrar PDF (más confiable) -->
      <iframe
        *ngIf="safePdfUrl && isOpen"
        [src]="safePdfUrl"
        class="w-full h-full border-0"
        title="Vista previa del PDF"
        (error)="onIframeError()">
      </iframe>
      
      <!-- Alternativa con ngx-extended-pdf-viewer (comentado hasta resolver assets) -->
      <!--
      <ngx-extended-pdf-viewer
        *ngIf="pdfUrl && isOpen"
        [src]="pdfUrl"
        [height]="'100%'"
        [zoom]="zoomLevel + '%'"
        [page]="currentPage"
        [showSidebarButton]="false"
        [showFindButton]="true"
        [showPagingButtons]="true"
        [showZoomButtons]="false"
        [showPresentationModeButton]="false"
        [showOpenFileButton]="false"
        [showPrintButton]="false"
        [showDownloadButton]="false"
        [showSecondaryToolbarButton]="false"
        [showRotateButton]="true"
        [showHandToolButton]="true"
        [showScrollingButton]="true"
        [showSpreadButton]="false"
        [backgroundColor]="darkMode ? '#1f2937' : '#ffffff'"
        (pagesLoaded)="onPdfLoadComplete($event)"
        (pageChange)="onPageChange($event)"
        class="w-full h-full">
      </ngx-extended-pdf-viewer>
      -->
    </div>
  </div>
</div>

